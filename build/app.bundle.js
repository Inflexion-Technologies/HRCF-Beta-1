!function(e){function t(u){if(n[u])return n[u].exports;var o=n[u]={i:u,l:!1,exports:{}};return e[u].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,u){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:u})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t){e.exports=require("express")},function(e,t){e.exports=require("request")},function(e,t,n){"use strict";var u=n(3);t.getHash=function(e){return n(21).createHmac("sha256","thequickfoxjumpedoverthelazydog").update(e).digest("hex")},t.isValidEmail=function(e){return/\S+@\S+\.\S+/.test(e)},t.isValidMSISDN=function(e){if(10===e.length){var t=u.toArray(e),n=u.map(t,function(e){if(u.toUpper(e)!==u.toLower(e))return console.log("Text contains alphabets"),!1});return!u.includes(n,!1)}return!1}},function(e,t){e.exports=require("lodash")},function(e,t,n){"use strict";var u=n(5),o={IP:process.env.SERVER_IP||"localhost",PORT:process.env.SERVER_PORT||8001},r=new u(process.env.DB_NAME||"HRCF",process.env.DB_USER||"root",process.env.DB_PASSWORD||"",{host:process.env.DB_HOST||"localhost",dialect:process.env.DB_DIALECT||"mysql",pool:{max:5,min:0,idle:1e4}});e.exports={config:o,sequelize:r}},function(e,t){e.exports=require("sequelize")},function(e,t,n){"use strict";function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),i=n(0),a=o(i),l=n(7),f=o(l),d=n(8),c=o(d),p=n(9),h=o(p),y=n(10),m=o(y),v=n(11),b=o(v),M=n(12),g=o(M),w=n(13),_=o(w),j=n(14),O=o(j),T=n(15),k=o(T),R=n(16),S=o(R),I=n(17),D=o(I),P=n(18),A=o(P),E=n(19),x=o(E),U=n(20),N=o(U),q=n(22),C=(o(q),n(23)),B=u(C),G=n(4),V=u(G),z=n(1),L=(o(z),function(){function e(){r(this,e),this.app=(0,a.default)(),this.initExpress(this.app),this.initSQLAndRouters(this.app),this.finalize(this.app)}return s(e,[{key:"initExpress",value:function(e){e.use(c.default.json({limit:"50mb"})),e.use(c.default.urlencoded({limit:"50mb",extended:!0})),e.use((0,f.default)()),e.use((0,b.default)([])),e.use((0,m.default)({resave:!0,saveUninitialized:!0,secret:"thequickbrownfoxjumpedoverthelazydogs",cookieName:"session",duration:18e5,activeDuration:3e5,httpOnly:!0,cookie:{secure:!1}})),e.use(function(e,t,n){t.header("Access-Control-Allow-Origin","*"),t.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),t.header("Access-Control-Allow-Methods","POST, GET, PUT, DELETE, OPTIONS"),n()}),e.use((0,h.default)("dev")),e.use(a.default.static("build")),e.use(function(e,t,n){t.header("Cache-Control","private, no-cache, no-store, must-revalidate"),t.header("Expires","-1"),t.header("Pragma","no-cache"),n()}),e.get("/",function(e,t){t.redirect("./index.html")})}},{key:"validate",value:function(e,t,n){if(e.session&&e.session.user){var u=V.sequelize;B.usersModel(u).findOne({where:{id:e.session.user.id,password:e.session.user.password}}).then(function(e){e?n():t.status(404).send("no session found")})}else t.status(404).send("please login")}},{key:"initSQLAndRouters",value:function(e){var t=V.sequelize,n=B.approveModel(t),u=B.bankModel(t),o=B.branchModel(t),r=B.companyModel(t),s=B.creditModel(t),i=B.transactionModel(t),a=B.withdrawalModel(t),l=B.usersModel(t);n.belongsTo(r),o.belongsTo(u),r.belongsTo(l),s.belongsTo(l),s.belongsTo(u),i.belongsTo(l),a.belongsTo(l),a.belongsTo(u),l.belongsToMany(n,{through:"user_approves"}),l.belongsToMany(o,{through:"user_branches"}),t.sync({force:!0});var f=new g.default(l),d=new _.default(n),c=new k.default(o),p=new S.default(r,l),h=new D.default(s,u,l),y=new A.default(i,l),m=new x.default(a,l),v=new O.default(u),b=new N.default(l);e.use("/api/v1/users",f.routes()),e.use("/api/v1/approvers",d.routes()),e.use("/api/v1/branches",c.routes()),e.use("/api/v1/companys",p.routes()),e.use("/api/v1/credits",h.routes()),e.use("/api/v1/transactions",y.routes()),e.use("/api/v1/withdrawals",m.routes()),e.use("/api/v1/banks",v.routes()),e.use("/api/v1/utils",b.routes())}},{key:"finalize",value:function(e){var t=V.config.PORT;e.listen(parseInt(t),function(){console.log("Running on PORT ::: "+t)})}}]),e}());t.default=L;new L},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("express-validator")},function(e,t,n){"use strict";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),r=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(r),i=function(){function e(t){u(this,e),this.UsersModel=t}return o(e,[{key:"routes",value:function(){var e=this,t=s.default.Router();return t.route("/").get(function(t,n){e.UsersModel.findAll().then(function(e){n.status(200).json("success")})}),t.route("/:id").get(function(e,t){}),t.route("/email/:email").get(function(e,t){}),t.route("/").post(function(t,n){0!=Object.keys(t.body)?e.UsersModel.create(t.body).then(function(e){n.status(200).json(e)}):0!=Object.keys(t.params)&&e.UsersModel.create(t.params).then(function(e){n.status(200).json(e)})}),t.route("/:id").delete(function(e,t){}),t}}]),e}();t.default=i},function(e,t,n){"use strict";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),r=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(r),i=function(){function e(t){u(this,e),this.ApproveModel=t}return o(e,[{key:"routes",value:function(){var e=this,t=s.default.Router();return t.route("/").get(function(t,n){e.ApproveModel.findAll().then(function(e){n.status(200).json(e)})}),t.route("/:id").get(function(e,t){}),t.route("/email/:email").get(function(e,t){}),t.route("/").post(function(t,n){0!=Object.keys(t.body)?e.ApproveModel.create(t.body).then(function(e){n.status(200).json(e)}):0!=Object.keys(t.params)&&e.ApproveModel.create(t.params).then(function(e){n.status(200).json(e)})}),t.route("/:id").delete(function(e,t){}),t}}]),e}();t.default=i},function(e,t,n){"use strict";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),r=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(r),i=function(){function e(t){u(this,e),this.Banks=t}return o(e,[{key:"routes",value:function(){var e=this,t=s.default.Router();return t.route("/").get(function(t,n){e.Banks.findAll({where:{status:"A"},limit:150}).then(function(e){n.status(200).json(e)})}),t.route("/:id").get(function(t,n){e.Banks.findById(t.params.id).then(function(e){n.status(200).json(e)})}),t.route("/").post(function(t,n){t.body?e.Banks.create(t.body).then(function(e){n.status(200).json(e)}):n.status(200).send("Data not saved!")}),t.route("/:id").delete(function(t,n){e.Banks.update({status:"D"},{where:{id:t.params.id}}).then(function(e){n.status(200).json(e)})}),t}}]),e}();t.default=i},function(e,t,n){"use strict";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),r=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(r),i=function(){function e(t){u(this,e),this.BranchModel=t}return o(e,[{key:"routes",value:function(){var e=this,t=s.default.Router();return t.route("/").get(function(t,n){e.BranchModel.findAll({where:{status:"A"},limit:150}).then(function(e){n.status(200).json(e)})}),t.route("/:id").get(function(t,n){e.BranchModel.findById(t.params.id).then(function(e){n.status(200).json(e)})}),t.route("/").post(function(t,n){t.body?e.BranchModel.create(t.body).then(function(e){n.status(200).json(e)}):n.status(200).send("Data not saved!")}),t.route("/:id").delete(function(t,n){e.BranchModel.update({status:"D"},{where:{id:t.params.id}}).then(function(e){n.status(200).json(e)})}),t}}]),e}();t.default=i},function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),s=n(0),i=u(s),a=n(1),l=(u(a),function(){function e(t,n){o(this,e),this.CompanyModel=t,this.UserModel=n}return r(e,[{key:"routes",value:function(){var e=this,t=i.default.Router();return t.route("/").get(function(t,n){e.CompanyModel.findAll({where:{status:"A"},limit:150,include:[e.UserModel]}).then(function(e){n.status(200).json(e)})}),t.route("/:id").get(function(t,n){e.CompanyModel.findById(t.params.id).then(function(e){n.status(200).json(e)})}),t.route("/user_id/:user_id").get(function(t,n){e.CompanyModel.findOne({where:{user_id:t.params.user_id},include:[e.UserModel]}).then(function(e){n.status(200).json(e)})}),t.route("/").post(function(t,n){t.body?e.CompanyModel.create(t.body).then(function(e){n.status(200).json(e)}):n.status(200).send("Data not saved!")}),t.route("/:id").delete(function(e,t){}),t}}]),e}());t.default=l},function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),s=n(0),i=u(s),a=n(1),l=(u(a),function(){function e(t,n,u){o(this,e),this.CreditModel=t,this.BankModel=n,this.UserModel=u}return r(e,[{key:"routes",value:function(){var e=this,t=i.default.Router();return t.route("/").get(function(t,n){e.CreditModel.findAll({where:{status:"A"},limit:150,include:[e.UserModel,e.BankModel]}).then(function(e){n.status(200).json(e)})}),t.route("/:id").get(function(t,n){e.CreditModel.findById(t.params.id).then(function(e){n.status(200).json(e)})}),t.route("/user_id/:user_id").get(function(t,n){e.CreditModel.findOne({where:{user_id:t.params.user_id},include:[e.UserModel,e.BankModel]}).then(function(e){n.status(200).json(e)})}),t.route("/").post(function(t,n){t.body?e.CreditModel.create(t.body).then(function(e){n.status(200).json(e)}):n.status(200).send("Data not saved!")}),t.route("/:id").delete(function(e,t){}),t}}]),e}());t.default=l},function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),s=n(0),i=u(s),a=n(1),l=(u(a),function(){function e(t,n){o(this,e),this.TransactionModel=t,this.UserModel=n}return r(e,[{key:"routes",value:function(){var e=this,t=i.default.Router();return t.route("/").get(function(t,n){e.TransactionModel.findAll({where:{status:"A"},limit:150,include:[e.UserModel]}).then(function(e){n.status(200).json(e)})}),t.route("/:id").get(function(t,n){e.TransactionModel.findById(t.params.id).then(function(e){n.status(200).json(e)})}),t.route("/user_id/:user_id").get(function(t,n){e.TransactionModel.findOne({where:{user_id:t.params.user_id},include:[e.UserModel]}).then(function(e){n.status(200).json(e)})}),t.route("/").post(function(t,n){t.body?e.TransactionModel.create(t.body).then(function(e){n.status(200).json(e)}):n.status(200).send("Data not saved!")}),t.route("/:id").delete(function(e,t){}),t}}]),e}());t.default=l},function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),s=n(0),i=u(s),a=n(1),l=(u(a),function(){function e(t,n){o(this,e),this.WithdrawalModel=t,this.UserModel=n}return r(e,[{key:"routes",value:function(){var e=this,t=i.default.Router();return t.route("/").get(function(t,n){e.WithdrawalModel.findAll({where:{status:"A"},limit:150,include:[e.UserModel]}).then(function(e){n.status(200).json(e)})}),t.route("/:id").get(function(t,n){e.WithdrawalModel.findById(t.params.id).then(function(e){n.status(200).json(e)})}),t.route("/user_id/:user_id").get(function(t,n){e.WithdrawalModel.findOne({where:{user_id:t.params.user_id},include:[e.UserModel]}).then(function(e){n.status(200).json(e)})}),t.route("/").post(function(t,n){t.body?e.WithdrawalModel.create(t.body).then(function(e){n.status(200).json(e)}):n.status(200).send("Data not saved!")}),t.route("/:id").delete(function(e,t){}),t}}]),e}());t.default=l},function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),s=n(0),i=u(s),a=n(1),l=(u(a),function(){function e(t){o(this,e),this.UsersModel=t}return r(e,[{key:"getUserDetails",value:function(e,t){e.status(200).json(t)}},{key:"routes",value:function(){var e=this,t=this,u=i.default.Router(),o=n(2);return u.route("/login").get(function(n,u){n.query&&n.query.username.trim().length>0&&n.query.password.trim().length>0?o.isValidEmail(n.query.username.trim())?t.UsersModel.findOne({where:{email:n.query.username,password:o.getHash(n.query.password)}}).then(function(t){t?(e.getUserDetails(u,t),n.session.user=t):u.status(200).json(t),e.getUserDetails(u,t)}):o.isValidMSISDN(n.query.username.trim())&&t.UsersModel.findOne({where:{msisdn:n.query.username,password:o.getHash(n.query.password)}}).then(function(t){t?(e.getUserDetails(u,t),n.session.user=t):u.status(200).json(t)}):u.status(200).send("Data not received")}),u.route("/is_email_exist/:email").get(function(e,n){o.isValidEmail(e.params.email.trim())?t.UsersModel.findOne({where:{email:e.params.email}}).then(function(e){e?n.status(200).json({is_exist:!0}):n.status(200).json({is_exist:!1})}):n.status(200).send("Wrong EMAIL format")}),u.route("/is_msisdn_exist/:msisdn").get(function(e,n){o.isValidMSISDN(e.params.msisdn.trim())?t.UsersModel.findOne({where:{msisdn:e.params.msisdn}}).then(function(e){e?n.status(200).json({is_exist:!0}):n.status(200).json({is_exist:!1})}):n.status(200).json("Wrong MSISN format")}),u}}]),e}());t.default=l},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}(),r=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(r),i=n(4),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),l=function(){function e(t){u(this,e),this.UsersModel=t}return o(e,[{key:"routes",value:function(){var e=this,t=s.default.Router(),u=n(2);return t.route("/register").get(function(t,n){a.config.sessions_username,a.config.sessions_password;e.UsersModel.findOne({where:{msisdn:"0244000000",password:u.getHash("000000")}}).then(function(e){e?(t.session.user=e,n.status(200).json({session:!0})):n.status(404).json("sessions error")})}),t.route("/:id").get(function(e,t){t.status(200).send("not implemented")}),t}}]),e}();t.default=l},function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}function o(e){return e.define("companys",{name:{type:p.default.STRING},status:{type:p.default.STRING(1)}},{underscored:!0})}function r(e){return e.define("transactions",{type:{type:p.default.DOUBLE,values:["W","C"]},status:{type:p.default.STRING(1)}},{underscored:!0})}function s(e){return e.define("withdrawals",{amount:{type:p.default.DOUBLE},status:{type:p.default.STRING(1)}},{underscored:!0})}function i(e){return e.define("credits",{amount:{type:p.default.DOUBLE},status:{type:p.default.STRING(1)}},{underscored:!0})}function a(e){return e.define("banks",{name:{type:p.default.STRING,set:function(e){this.setDataValue("name",y.default.capitalize(e).trim())}},code:{type:p.default.STRING},status:{type:p.default.STRING(1),defaultValue:"A"}},{underscored:!0})}function l(e){return e.define("bank_branches",{name:{type:p.default.STRING},code:{type:p.default.STRING},status:{type:p.default.STRING(1),defaultValue:"A"}},{underscored:!0})}function f(e){return e.define("approvers",{firstname:{type:p.default.STRING,set:function(e){this.setDataValue("firstname",y.default.capitalize(e).trim())}},lastname:{type:p.default.STRING,set:function(e){this.setDataValue("lastname",y.default.capitalize(e).trim())}},email:{type:p.default.STRING,unique:!0,validate:{isEmail:!0},set:function(e){this.setDataValue("email",e.trim())}},msisdn:{type:p.default.STRING,unique:!0,validate:{isNumeric:!0},set:function(e){this.setDataValue("msisdn",e.trim())}},status:{type:p.default.STRING(1),defaultValue:"A"}},{underscored:!0})}function d(e){return e.define("users",{firstname:{type:p.default.STRING,set:function(e){this.setDataValue("firstname",y.default.capitalize(e).trim())}},lastname:{type:p.default.STRING,set:function(e){this.setDataValue("lastname",y.default.capitalize(e).trim())}},email:{type:p.default.STRING,unique:!0,validate:{isEmail:!0},set:function(e){this.setDataValue("email",e.trim())}},msisdn:{type:p.default.STRING,unique:!0,validate:{isNumeric:!0},set:function(e){this.setDataValue("msisdn",e.trim())}},type:{type:p.default.ENUM,values:["C","I"]},password:{type:p.default.STRING,set:function(e){this.setDataValue("password",m.getHash(e.trim()))}},validate:{type:p.default.BOOLEAN,defaultValue:!0},status:{type:p.default.STRING(1),defaultValue:"A"}},{underscored:!0})}Object.defineProperty(t,"__esModule",{value:!0}),t.companyModel=o,t.transactionModel=r,t.withdrawalModel=s,t.creditModel=i,t.bankModel=a,t.branchModel=l,t.approveModel=f,t.usersModel=d;var c=n(5),p=u(c),h=n(3),y=u(h),m=n(2)}]);